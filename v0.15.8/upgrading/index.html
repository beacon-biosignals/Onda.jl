<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Upgrading From Older Versions Of Onda · Onda</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Onda</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">API Documentation</a></li><li class="is-active"><a class="tocitem" href>Upgrading From Older Versions Of Onda</a><ul class="internal"><li><a class="tocitem" href="#To-v0.15-From-v0.14"><span>To v0.15 From v0.14</span></a></li><li><a class="tocitem" href="#To-v0.14-From-v0.13"><span>To v0.14 From v0.13</span></a></li><li><a class="tocitem" href="#To-v0.14-From-v0.11-Or-Older"><span>To v0.14 From v0.11 Or Older</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Upgrading From Older Versions Of Onda</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Upgrading From Older Versions Of Onda</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/beacon-biosignals/Onda.jl/blob/main/docs/src/upgrading.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Upgrading-From-Older-Versions-Of-Onda"><a class="docs-heading-anchor" href="#Upgrading-From-Older-Versions-Of-Onda">Upgrading From Older Versions Of Onda</a><a id="Upgrading-From-Older-Versions-Of-Onda-1"></a><a class="docs-heading-anchor-permalink" href="#Upgrading-From-Older-Versions-Of-Onda" title="Permalink"></a></h1><h2 id="To-v0.15-From-v0.14"><a class="docs-heading-anchor" href="#To-v0.15-From-v0.14">To v0.15 From v0.14</a><a id="To-v0.15-From-v0.14-1"></a><a class="docs-heading-anchor-permalink" href="#To-v0.15-From-v0.14" title="Permalink"></a></h2><p>First, ensure your codebase is fully upgraded to Onda v0.14, including resolving all deprecation warnings.</p><p>From there, breaking changes include:</p><ul><li><p>Functionality that was &quot;soft-deprecated&quot; in Onda v0.14 (i.e. code would still work, but warnings would be raised) is now &quot;hard-deprecated&quot; as of Onda v0.15.</p></li><li><p>Onda is now built atop Legolas v0.5, instead of Legolas v0.4. Users of Onda v0.15 must therefore upgrade their usage of Legolas to Legolas v0.5 (see <a href="https://github.com/beacon-biosignals/Legolas.jl/pull/54">here for details</a>). One of the most significant implications of this breaking change is that <code>Annotation</code> and <code>Signal</code> (formerly, aliases of the old <code>Legolas.Row</code> type) have been replaced with <code>AnnotationV1</code> and <code>SignalV2</code> (subtypes of the new <code>Legolas.AbstractRecord</code> type). The latter types have slightly different semantics than the former, especially in that the new types do not propagate non-required fields in the same manner as the old types. Even though a comprehensive deprecation path isn&#39;t provided, invocations of <code>Annotation(...)</code>/<code>Signal(...)</code> will now throw a descriptive error with suggestions on how to upgrade.</p></li><li><p><code>onda.samples-info@2</code> and <code>onda.signal@2</code> have been introduced, which replace <code>onda.samples-info@1</code> and <code>onda.signal@1</code> respectively. Onda still declares/provides these first-generation schema versions, so that corresponding <code>Legolas.read</code> invocations may still work as expected, but all other Onda v0.15 API structures/functions utilize (and/or expect) the second-generation schema versions. Onda v0.15 provides <a href="../#Onda.upgrade"><code>Onda.upgrade</code></a> to conveniently upgrade first-generation data to the new generation.</p></li><li><p>The functions <code>Onda.write_signals</code>, <code>Onda.write_annotations</code>, and <code>Onda.validate</code> have been soft-deprecated, and will thus continue to work - but will raise deprecation warnings - until the next breaking version update.</p></li></ul><h2 id="To-v0.14-From-v0.13"><a class="docs-heading-anchor" href="#To-v0.14-From-v0.13">To v0.14 From v0.13</a><a id="To-v0.14-From-v0.13-1"></a><a class="docs-heading-anchor-permalink" href="#To-v0.14-From-v0.13" title="Permalink"></a></h2><p>Potentially breaking changes include:</p><ul><li><p><code>SamplesInfo</code>&#39;s <code>sample_type</code> field is now an <code>AbstractString</code> (see <code>sample_type</code> in https://github.com/beacon-biosignals/Onda.jl#columns) as opposed to a <code>DataType</code>. The <a href="../#Onda.sample_type-Tuple{Any}"><code>sample_type</code></a> function should now be used to retrieve this field as a <code>DataType</code>.</p></li><li><p>Since <code>SampleInfo</code>/<code>Signal</code>/<code>Annotation</code> are now <a href="https://beacon-biosignals.github.io/Legolas.jl/stable/#Legolas.Row"><code>Legolas.Row</code> aliases</a>, any instance of these types may contain additional author-provided fields atop required fields. Thus, code that relies on these types containing a specific number of fields (or similarly, a specific field order) might break in generic usage.</p></li></ul><p>Otherwise, there are no intended breaking changes from v0.13 to v0.14 that do not have a supported deprecation path. These deprecation paths will be maintained for at least one <code>0.x</code> release cycle. To upgrade your code, simply run your code/tests with Julia&#39;s <code>--depwarn=yes</code> flag enabled and make the updates recommended by whatever deprecation warnings arise.</p><h2 id="To-v0.14-From-v0.11-Or-Older"><a class="docs-heading-anchor" href="#To-v0.14-From-v0.11-Or-Older">To v0.14 From v0.11 Or Older</a><a id="To-v0.14-From-v0.11-Or-Older-1"></a><a class="docs-heading-anchor-permalink" href="#To-v0.14-From-v0.11-Or-Older" title="Permalink"></a></h2><p>Before Onda.jl v0.12, signal and annotation metadata was stored (both in-memory, and serialized) in a nested <code>Dict</code>-like structure wrapped by the <code>Onda.Dataset</code> type. In the Onda.jl v0.12 release, we dropped the <code>Onda.Dataset</code> type and instead switched to storing signal and annotation metadata in separate Arrow tables. See <a href="https://github.com/beacon-biosignals/OndaFormat/issues/25">here</a> for the motivations behind this switch.</p><p>Tips for upgrading:</p><ul><li><p>Onda.jl v0.13 contains a convenience function, <code>Onda.upgrade_onda_dataset_to_v0_5!</code>, to automatically upgrade old datasets to the new format. This function has since been removed after several deprecation cycles, but it can still be invoked as needed by <code>Pkg.add</code>ing/<code>Pkg.pin</code>ing Onda at <code>version=&quot;0.13&quot;</code>. See <a href="https://github.com/beacon-biosignals/Onda.jl/blob/eb2623dc3fe436850667c646aa7c329485c61046/src/Onda.jl#L34-L70">the function&#39;s docstring</a> for more details.</p></li><li><p>The newer tabular format enables consumers/producers to easily impose whatever indexing structure is most convenient for their use case, including the old format&#39;s indexing structure. This can be useful for upgrading old code that utilized the old <code>Onda.Recording</code>/<code>Onda.Dataset</code> types. Specifically, the <a href="https://github.com/beacon-biosignals/Onda.jl/blob/master/examples/tour.jl">Onda Tour</a> shows how tables in the new format can indexed in the same manner as the old format via a few simple commands. This tour is highly recommended for authors that are upgrading old code, as it directly demonstrates how to perform many common Onda operations (e.g. sample data storing/loading) using the latest version of the package.</p></li><li><p>The following changes were made to <code>Onda.Signal</code>:</p><ul><li>Formerly, each signal was stored as the pair <code>kind::Symbol =&gt; metadata</code> within a dictionary keyed to a specific <code>recording::UUID</code>. Now that each signal is a self-contained table row, each signal contains its own <code>recording::UUID</code> and <code>kind::String</code> fields. Note that, unlike the old format, the new data model allows the existence of multiple signals of the same <code>kind</code> in the same <code>recording</code> (see <a href="https://github.com/beacon-biosignals/Onda.jl/README.md#columns">here</a> for guidance on the interpretation of such data). If a primary key is needed to identify individual sample data artifacts, use the <code>file_path</code> field instead of the <code>kind</code> field.</li><li>The <code>file_extension</code>/<code>file_options</code> fields were replaced by the <code>file_path</code>/<code>file_format</code> fields.</li><li>The <code>channel_names::Vector{Symbol}</code> field was changed to <code>channels::Vector{String}</code>.</li><li>The <code>start_nanosecond</code>/<code>stop_nanosecond</code> fields were replaced with a single <code>span::TimeSpan</code> field.</li><li>The <code>sample_unit::Symbol</code> field was changed to <code>sample_unit::String</code>.</li></ul></li><li><p>The following changes were made to <code>Onda.Annotation</code>:</p><ul><li>Formerly, annotations were stored as a simple list keyed to a specific <code>recording::UUID</code>. Now that each annotation is a self-contained table row, each annotation contains its own <code>recording::UUID</code> and <code>id::UUID</code> fields. The latter field serves as a primary key to identify individual annotations.</li><li>The <code>start_nanosecond</code>/<code>stop_nanosecond</code> fields were replaced with a single <code>span::TimeSpan</code> field.</li><li>The <code>value</code> field was dropped in favor of allowing annotation authors to provide arbitrary custom columns tailored to their use case.</li></ul></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« API Documentation</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Wednesday 11 September 2024 16:29">Wednesday 11 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
